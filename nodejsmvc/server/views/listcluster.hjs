<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="language" content="en" />
        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
	<link rel="stylesheet" type="text/css" href="../stylesheets/screen.css" media="screen, projection" />
	<link rel="stylesheet" type="text/css" href="../stylesheets/print.css" media="print" />
        <link rel="stylesheet" type="text/css" href="../stylesheets/cloud.css" media="screen, projection" />
	<link rel="stylesheet" type="text/css" href="../stylesheets/tooltip.css" media="screen, projection" />
	<link rel="stylesheet" type="text/css" href="../stylesheets/main.css" />
	<link rel="stylesheet" type="text/css" href="../stylesheets/form.css" />
        <link rel="stylesheet" type="text/css" href="../stylesheets/jqueryslidemenu.css" />
        <link media="screen" rel="stylesheet" href="../stylesheets/simplemodal/basic/css/demo.css" type="text/css">
        <link media="screen" rel="stylesheet" href="../stylesheets/simplemodal/basic/css/basic.css" type="text/css">
        <link rel="stylesheet" type="text/css" href="../stylesheets/jquery.confirm.css" />
        <link rel="stylesheet" type="text/css" href="../stylesheets/pure-min.css" />
        <script type="text/javascript" src="../javascripts/jquery.js"></script>
	<script type="text/javascript" src="../javascripts/tablesorter/jquery-latest.js"></script>
        <script type="text/javascript" src="../javascripts/jqueryslidemenu.js"></script> 
        <script type="text/javascript" src="../javascripts/simplemodal/basic/js/basic.js"></script>
        <script type="text/javascript" src="../javascripts/simplemodal/basic/js/jquery.simplemodal.js"></script>
	<link rel="stylesheet" type="text/css" href="../javascripts/tablesorter/blue/style.css" />

	<title>List Clusters </title>
</head>

<body>

<div class="container main_wrapper" id="page">


        <div class="row_6">
                <div class="company_logo">
                        <img class="image" src="../images/logo.png" height="64" width="39">
                        <h2>
                                <span style="font-weight: normal;" class="span">IT Cloud Physical&nbsp;</span>
                        </h2>
                </div>
                <p>
                        <span style="font-family: Tahoma, Geneva, sans-serif; position: relative; top: 10px; " class="span5">
                                <span style="color: rgb(245, 240, 245); font-size: 23px; line-height: 23px;top:-5px;left:20px;position:relative; ">Cluster Service</span>
                        </span>
                </p>
                <p style="position:relative;text-align:right;color:#fff;font-family: Tahoma, Geneva, sans-serif;margin-right:10px;">Welcome, EMAIL_OF_USER
                   {{firstname}}&nbsp;{{lastname}}
		</p>
        </div>

	<div id="myslidemenu" class=" jqueryslidemenu" style='width: 100%'>
<ul>
	        <li><a href="/clusterslist/">My Clusters</a></li>
  		       <!-- <ul>
  		            <li><a href="#">Link</a></li>
  			        <li><a href="#">Link</a></li>
  			        <li><a href="#">Link</a></li>
  		        </ul>
                     </li>-->
                <li><a href="#">Documentation</a></li>
                <li><a href="#">Support</a></li>
	</div><!-- mainmenu -->
        <div class='content'>
<style>
.listserver td{
	padding-top: 5px;
}
</style>
<div class="listserver" style="padding:0px;width:100%;font-family:Tahoma,Geneva,sans-serif">
    <h2 style="color:#FFF;font-size:1.6em;margin:10px 15px 0px 15px;padding:10px;background-image:linear-gradient(to bottom, #756C75 88%, #756C75 97%)">List Clusters</h2>
            <div id="msgBox" class="" style="display:none; width: 700px; margin-bottom: 15px; top:10px;">
           <div id="message" class='error' style="margin-left: 20px; width: 126%; border: 2px solid; padding: 5px 0 5px 5px;">{{message}}</div>
           <div style="clear:both"></div>
       </div>
<table border="0" ><!--class="pure-table">-->
<tr>
<td width="200px">
                   <div class="row">
            <div class="col-lg-12 vcenter">
<div id="clusterpiechart0" style="min-width: 200px; height: 200px; max-width: 200px; margin: 0 auto vcenter"></div>
</div>
</div>
</td>
<td width="200px">
                   <div class="row">
            <div class="col-lg-12 vcenter">
<div id="clusterpiechart1" style="min-width: 200px; height: 200px; max-width: 200px; margin: 0 auto vcenter"></div>
</div>
</div>
</td>
<td width="200px">
                   <div class="row">
            <div class="col-lg-12 vcenter">
<div id="clusterpiechart2" style="min-width: 200px; height: 200px; max-width: 200px; margin: 0 auto vcenter"></div>
</div>
</div>
</td>
<td width="200px">
                   <div class="row">
            <div class="col-lg-12 vcenter">
<div id="clusterpiechart3" style="min-width: 200px; height: 200px; max-width: 200px; margin: 0 auto vcenter"></div>
</div>
</div>
</td>
</tr>
</table>
<table style='width: 100%'>
    <thead>
        <tr>
            <th>Name</th>
            <th>Total Cpu</th>
            <th>Memory Size</th>
            <th>Storage Size</th>
            <th>Status</th>
            <th>Action</th>
        </tr>
    </thead>

    <tbody>
LIST_OF_CLUSTERS
    </tbody>
</table>
    <div class="form row buttons" style="margin: 10px 0px; width: 110px; min-height: 32px;">
        <table><tr><td>
        <input type="button" id="btnAddcluster" class='' name="yt1" value="Create Cluster" style='background-color: #7a0d0d;color: #fff; border-radius: 5px;padding: 5px; width: 130px;'>
         </td><td>
        </td></tr></table>
    </div>
</div>
<script type="text/javascript">

    $('#btnChangeProject').click(function(){
        window.location.href = '/storage/?r=cluster/changeproject';
    });

    $('#btnAddcluster').click(function(){
        window.location.href = '/clusteradd/';
    });

$(document).ready(function(){
    drawCharts();
    $('#btnAddcluster').click(function(){
	window.location.href = '/clusteradd/';
    });

    $(".actionServer").on("change",null, function(){

        var action = $(this).val();
        var actionId = this.id;
        var idStr = actionId.split("_");
        var id = idStr[1];
        var name = id;
        //var name = $("#shName_"+id).val();
        if(action === 'delete')
            deleteCluster(name);
        //else if(action === 'modify')
        //    modifyCluster(name);
        else if(action === 'grpmgr')
            manageGroup();
        //else if(action === 'detail')
        //    detailCluster(name);
    });
    renderFlash("{{message}}");
});
function renderFlash(msg){
 if (msg != ""){
  $('#msgBox').show();
}
}
function manageGroup(){
  var win = window.open('https://groupmanager.com/view-users.html#getUserId', '_blank');
  win.focus();
     //window.location.href = 'https://groupmanager.com/view-users.html#getUserId';
}

function modifyCluster(name){

    $('<div id="modDiv"><img src="../images/loader.gif">').load('/clusteredit/?name=' + name).modal({
            position:["10%","30%"],
            minHeight: 720,
            dataCss: {"overflow":"hidden","width":"680px"},
            minWidth: 680,
            windowClass: 'no-animation-modal',
            onClose: function(){
                    $(".actionServer").val("");
                    $.modal.close();
            }
    });
}

function detailCluster(name){

    $('<div id="modDiv"><img src="../images/loader.gif">').load('/clusterdetail/?name=' + name).modal({
            position:["10%","30%"],
            minHeight: 720,
            dataCss: {"overflow":"hidden","width":"680px", "height":"720px"},
            minWidth: 680,
            windowClass: 'no-animation-modal',
            onClose: function(){
                    $(".actionServer").val("");
                    $.modal.close();
            }
    });
}

function deleteCluster(name){

    $.confirm({
        'title'	: 'Delete Cluster',
        'message'	: 'You are about to delete cluster <strong>'+ name  +'</strong>.<br/> <br />WARNING! this action can not be undone.',
        'buttons'	: {
            'Yes'	: {
                'class'	: 'blue',
                'action': function(){
                    window.location.href = '/clusterdelete/?name=' + name;
                }
            },
            'No'	: {
                'class'	: 'gray',
                'action': function(){return false;}	
            }
        }
    });
}
function drawCharts() {
var data = CLUSTERS_JSON;
var instancesCount = [];
var vcpuCount = [];
var ramCount = [];
var storageCount = [];
        data.forEach( function (dataItem, index){
             instancesCount.push({name:dataItem.name, y:dataItem.slaveCount, color:Highcharts.getOptions().colors[index]});
             vcpuCount.push({name:dataItem.name, y:dataItem.cpuCount, color:Highcharts.getOptions().colors[index]}); // cpuCount & totalCpu used interchangeably
             ramCount.push({name:dataItem.name, y:dataItem.memorySize, color:Highcharts.getOptions().colors[index]});
             storageCount.push({name:dataItem.name, y:dataItem.storageSize, color:Highcharts.getOptions().colors[index]});
        });
        if (instancesCount.length > 0 ){
        pieChart('clusterpiechart0', 'Instances', 'Instances', instancesCount);
        pieChart('clusterpiechart1', 'Total CPU', 'Total CPU', vcpuCount);
        pieChart('clusterpiechart2', 'Memory Size', 'MemorySize', ramCount);
        pieChart('clusterpiechart3', 'Storage Size', 'Storage Size', storageCount);
        }else{
             instancesCount.push({name:"", y:0, color:Highcharts.getOptions().colors[0]});
             vcpuCount.push({name:"", y:0, color:Highcharts.getOptions().colors[0]});
             ramCount.push({name:"", y:0, color:Highcharts.getOptions().colors[0]});
             storageCount.push({name:"", y:0, color:Highcharts.getOptions().colors[0]});
        pieChart('clusterpiechart0', 'Instances', 'Instances', instancesCount);
        pieChart('clusterpiechart1', 'Total CPU', 'Total CPU', vcpuCount);
        pieChart('clusterpiechart2', 'Memory Size', 'MemorySize', ramCount);
        pieChart('clusterpiechart3', 'Storage Size', 'Storage Size', storageCount);
   
        $('#clusterpiechart').html("You don't have any clusters yet.");
        $('#message').html("You don't have any clusters yet.");
        }
};
</script>
        </div>
        <div class="clear"></div>
        <div class="copyright">
                <i class="paragraph2">
                     <span style="font-family: 'Trebuchet MS', sans-serif; " class="span6">© 2014 All Rights Reserved. </span>
                     <span class="privacy_policy privacy_policyspanCopy">
                         <span style="font-family: 'Trebuchet MS', sans-serif;">Privacy Policy.</span>
                     </span>
                </i>
        </div>
</div><!-- page -->
<script type='text/javascript'>
        $("#outer").click(function(){
                var option = $("#outer").val();
                if(option == 'advanced')
                        window.location.href = '/?p=advanced';
                else if(option == 'public')
                        window.location.href = '/amp';
        });
</script>
</body>
<script src="//code.jquery.com/jquery-1.11.2.js"></script>
 <script src="../javascripts/bootbox.min.js"></script>
 <script src="../javascripts/jquery.confirm.js"></script>
 <script src="../javascripts/bootstrap.min.js"></script>
<!--<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>-->
<script type="text/javascript" src="../javascripts/simplemodal/basic/js/jquery.simplemodal.js"></script>
<script type="text/javascript" src="../javascripts/simplemodal/basic/js/basic.js"></script>
<script type="text/javascript" src="../javascripts/piechart.js"></script>
<!--<script src="//code.jquery.com/jquery-1.11.2.js"></script>
 <script src="../javascripts/bootbox.min.js"></script>
 <script src="../javascripts/jquery.confirm.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>-->
<script type="text/javascript" src="../javascripts/piechart.js"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
</html>
